function i18n(t){return window.translations?.[t]||`[${t}]`}function applyTranslations(){document.querySelectorAll("[data-i18n]").forEach((t=>{const e=i18n(t.getAttribute("data-i18n"));e&&(t.textContent=e)})),document.querySelectorAll("[data-i18n-placeholder]").forEach((t=>{const e=i18n(t.getAttribute("data-i18n-placeholder"));e&&t.setAttribute("placeholder",e)})),document.querySelectorAll("[data-i18n-title]").forEach((t=>{const e=i18n(t.getAttribute("data-i18n-title"));e&&t.setAttribute("title",e)})),document.querySelectorAll("[data-i18n-value]").forEach((t=>{const e=i18n(t.getAttribute("data-i18n-value"));e&&(t.value=e)})),document.querySelectorAll("[data-i18n-aria]").forEach((t=>{const e=i18n(t.getAttribute("data-i18n-aria"));e&&t.setAttribute("aria-label",e)}))}function applyTranslations(){document.querySelectorAll("[data-i18n]").forEach((t=>{const e=i18n(t.getAttribute("data-i18n"));e&&(/<\/?[a-z][\s\S]*>/i.test(e)?t.innerHTML=e:t.textContent=e)})),document.querySelectorAll("[data-i18n-placeholder]").forEach((t=>{const e=i18n(t.getAttribute("data-i18n-placeholder"));e&&t.setAttribute("placeholder",e)})),document.querySelectorAll("[data-i18n-title]").forEach((t=>{const e=i18n(t.getAttribute("data-i18n-title"));e&&t.setAttribute("title",e)})),document.querySelectorAll("[data-i18n-value]").forEach((t=>{const e=i18n(t.getAttribute("data-i18n-value"));e&&(t.value=e)})),document.querySelectorAll("[data-i18n-aria]").forEach((t=>{const e=i18n(t.getAttribute("data-i18n-aria"));e&&t.setAttribute("aria-label",e)}))}const apiKey="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";function sendToAI(t){const e=document.getElementById("ai-input").value.trim(),n=document.getElementById("ai-result");if(!e)return void(n.textContent=i18n("ai_input_empty"));n.textContent=i18n("ai_loading");const a=`${{compress:i18n("task_compress"),ideas:i18n("task_ideas"),analyze:i18n("task_analyze")}[t]}\n${e}`;fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({model:"openai/gpt-3.5-turbo",messages:[{role:"user",content:a}]})}).then((t=>t.json())).then((t=>{t.choices?.[0]?.message?.content?n.textContent=t.choices[0].message.content.trim():t.detail?n.textContent=`${i18n("ai_error_detail")}: ${t.detail}`:n.textContent=i18n("ai_error_no_response")})).catch((t=>{n.textContent=`${i18n("ai_error_connection")}: ${t.message}`}))}document.addEventListener("DOMContentLoaded",(()=>{const t=new URLSearchParams(window.location.search).get("lang")||localStorage.getItem("lang")||"ru";localStorage.setItem("lang",t),fetch(`lang/${t}.json`).then((t=>t.json())).then((t=>{window.translations=t,applyTranslations(),document.getElementById("ai-compress").onclick=()=>sendToAI("compress"),document.getElementById("ai-ideas").onclick=()=>sendToAI("ideas"),document.getElementById("ai-analyze").onclick=()=>sendToAI("analyze")})).catch((t=>{console.error("❌ Ошибка загрузки перевода:",t)}))}));